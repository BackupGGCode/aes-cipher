/******************************************************************************/
/*  Class HEXFILE                                                             */
/*  PO: S. Maslyakov, rusoil.9@gmail.com                                      */
/*                                                                            */
/*  Revision:     1.2                                                         */
/*  Date:         2011/02/03 13:14:33                                         */
/******************************************************************************/


#ifndef __HEXFILE_H
#define __HEXFILE_H


#include "hex_def.h"


//==============================================================================
//  Class HEXFILE
//==============================================================================
class HEXFILE
{
    //==========================================================================
    // App: Constructor
    //==========================================================================
    protected: HEXFILE() {}
    //==========================================================================
    //==========================================================================


    //==========================================================================
    // App: Destructor
    //==========================================================================
    public: virtual ~HEXFILE() {
        if (m_data.hexFile.is_open()) {
            m_data.hexFile.close();
        };
    }
    //==========================================================================
    //==========================================================================


    //==========================================================================
    // App: Convert hex string to bin
    //==========================================================================
    public: static uint8_t HexToBin(const int8_t * _pHex);
    //==========================================================================
    //==========================================================================


    //==========================================================================
    // App: Read string from file
    //==========================================================================
    private: uint32_t ReadString(__RECLEN_HEADER_HEX& _recHeader);
    //==========================================================================
    //==========================================================================


    //==========================================================================
    // App: Insert void data
    //==========================================================================
    private: void InsertVoidData(std::vector <uint8_t>& _dst,
                                 const std::size_t _count);
    //==========================================================================
    //==========================================================================


    //==========================================================================
    // App: Get bin data vector
    //==========================================================================
    protected: const std::vector <uint8_t>& GetData() const {
        return m_data.data;
    }
    //==========================================================================
    //==========================================================================


    //==========================================================================
    // App: Open hex file
    //==========================================================================
    protected: bool_t OpenHexFile(const std::string& _name);
    //==========================================================================
    //==========================================================================


    //==========================================================================
    // App: Print error
    //==========================================================================
    protected: void PrintError(const uint32_t _error);
    //==========================================================================
    //==========================================================================


    //==========================================================================
    // App: Run conversion
    //==========================================================================
    protected: uint32_t RunConversion();
    //==========================================================================
    //==========================================================================


    private: __DATA_HEX          m_data;
    private: __PARSING_TOOLS_HEX m_tools;
    private: __STAT_INFO_HEX     m_info;
};
//==============================================================================
//==============================================================================


#endif